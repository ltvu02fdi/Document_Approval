<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <data>
        <template id="ev_internal_layout_document_approval_client_request">
            <div class="article">
                <t t-raw="0"/>
            </div>
        </template>
        <template id="report_template_document_approval_client_request_view">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="document_apporval_custom.ev_internal_layout_document_approval_client_request"
                       t-lang="en_US">
                        <div class="page" style="font-size:14px; font-family: 'Times New Roman'">
                            <style>
                                body, table, td, th, div, span {
                                font-family: 'Times New Roman', Times, serif !important;
                                }
                                .table {
                                border-collapse: collapse;
                                width: 100%;
                                }
                                .table th, .table td {
                                border: 1px solid black;
                                padding: 5px;
                                }
                                .no-border-table {
                                border: none !important;
                                border-collapse: separate !important;
                                width: 100%;
                                }
                                .no-border-table th,
                                .no-border-table td {
                                border: none !important;
                                padding: 3px;
                                }
                            </style>

                            <!-- Phần đầu: không viền -->
                            <table class="no-border-table">
                                <tr>
                                    <td width="65%">
                                        <div style="padding-right:20px;font-size:14px">
                                            <b><span t-esc="o.company_id.name" style="text-transform: uppercase;"/></b>
                                            <br/>
                                            <span t-esc="o.company_id.street"/>
                                        </div>
                                    </td>
                                    <td width="35%" style="text-align: right;">
                                        <img t-if="o.company_id.logo" t-att-src="image_data_uri(o.company_id.logo)"
                                             style="max-width:150px;max-height:150px;" alt="Company Logo"/>
                                    </td>
                                </tr>
                            </table>
                            <br/>

                            <!-- Tiêu đề -->
                            <div style="width: 100%; margin-top: 10px; padding: 5px; text-align: center;">
                                <h3 style="margin: 0; font-size:22px; font-weight: 500;">
                                    <b>PHIẾU ĐỀ XUẤT TIẾP KHÁCH</b>
                                </h3>
                                <i>
                                    <b>
                                        Ngày
                                        <span t-esc="(o.create_date + relativedelta(hours=7)).strftime('%d')"/>
                                        tháng
                                        <span t-esc="(o.create_date + relativedelta(hours=7)).strftime('%m')"/>
                                        năm
                                        <span t-esc="(o.create_date + relativedelta(hours=7)).strftime('%Y')"/>
                                    </b>
                                </i>
                            </div>
                            <!-- Kính gửi -->
                            <div style="width: 98%; margin-top: 10px; padding: 5px; text-align: center; font-size:16px;">
                                <b>Kính gửi:</b> <b>BAN LÃNH ĐẠO <span t-esc="o.company_id.name"/></b>
                            </div>

                            <!-- Thông tin đề nghị -->
                            <div style="margin-top: 10px;">
                                <div>
                                    <span style="display:inline-block; min-width:150px;">- Người đề xuất</span>
                                    <span style="display:inline-block; width:10px; text-align:center;">:</span>
                                    <span t-esc="o.request_employee_id.name"/>
                                </div>
                                <div>
                                    <span style="display:inline-block; min-width:150px;">- Chức danh</span>
                                    <span style="display:inline-block; width:10px; text-align:center;">:</span>
                                    <span t-esc="o.job_id.name"/>
                                </div>
                                <div>
                                    <span style="display:inline-block; min-width:150px;">- Bộ phận</span>
                                    <span style="display:inline-block; width:10px; text-align:center;">:</span>
                                    <span t-esc="o.department_id.name"/>
                                </div>
                                <div>
                                    <span style="display:inline-block; min-width:150px;">- Lý do tiếp khách</span>
                                    <span style="display:inline-block; width:10px; text-align:center;">:</span>
                                    <span t-esc="o.description"/>
                                </div>
                            </div>
                            <!-- Thông tin khách hàng -->
                            <div style="margin-top: 20px; width: 94%; float: right;">
                                <div>
                                    <span style="display:inline-block; min-width:150px;">- Tên đoàn khách</span>
                                    <span style="display:inline-block; width:10px; text-align:center;">:</span>
                                    <span t-esc="o.client_name"/>
                                </div>
                                <div>
                                    <span style="display:inline-block; min-width:150px;">- Trưởng đoàn (tên)</span>
                                    <span style="display:inline-block; width:10px; text-align:center;">:</span>
                                    <span t-esc="o.client_lead"/>
                                </div>
                                <div>
                                    <span style="display:inline-block; min-width:150px;">- Thành viên (số nguời)</span>
                                    <span style="display:inline-block; width:10px; text-align:center;">:</span>
                                    <span t-esc="o.team_member"/>
                                </div>
                                <div>
                                    <span style="display:inline-block; min-width:150px;">- Thời gian tiếp khách</span>
                                    <span style="display:inline-block; width:10px; text-align:center;">:</span>
                                    <span t-esc="o.date_hospitality"/>
                                </div>
                                <div>
                                    <span style="display:inline-block; min-width:150px;">- Nơi tiếp khách</span>
                                    <span style="display:inline-block; width:10px; text-align:center;">:</span>
                                    <span t-esc="o.venue"/>
                                </div>
                                <div>
                                    <span style="display:inline-block; min-width:150px;">- Chi phí dự kiến</span>
                                    <span style="display:inline-block; width:10px; text-align:center;">:</span>
                                    <span t-esc="o.price_unit"/>
                                </div>
                            </div>

                            <div style="margin-top: 20px; width: 94%; float: right;">
                                <div> Kính mong Ban lãnh đạo Công Ty xem xét!
                                </div>
                            </div>

                            <!-- Chữ ký: không viền -->
                            <table class="no-border-table" style="margin-top: 30px;">
                                <tr>
                                    <td width="20%">
                                    </td>
                                    <td width="20%">
                                    </td>
                                    <td width="20%">
                                    </td>
                                    <td width="20%" style="text-align: center;">
                                    </td>
                                    <td width="20%" style="text-align: center;">
                                    </td>
                                </tr>
                                <tr style="text-align: center;">
                                    <td>
                                        <b>Ban giám đốc</b>
                                        <br/>
                                        <p style="font-style:italic">(Ký, họ tên)</p>
                                        <br/>
                                        <b>Đã duyệt</b>
                                    </td>
                                    <td>
                                    </td>
                                    <td>
                                        <b>Trưởng bộ phận</b>
                                        <br/>
                                        <p style="font-style:italic">(Ký, họ tên)</p>
                                        <br/>
                                        <b>Đã duyệt</b>
                                    </td>
                                    <td>
                                    </td>
                                    <td>
                                        <b>Người đề nghị</b>
                                        <br/>
                                        <p style="font-style:italic">(Ký, họ tên)</p>
                                        <br/>
                                        <b>Đã duyệt</b>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </t>
                </t>
            </t>
        </template>


        <record id="paperformat_qweb_document_approval_client_request" model="report.paperformat">
            <field name="name">A4 Document Approval Client Request</field>
            <field name="default" eval="True"/>
            <field name="format">A4</field>
            <field name="page_height">0</field>
            <field name="page_width">0</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">8</field>
            <field name="margin_bottom">8</field>
            <field name="margin_left">6</field>
            <field name="margin_right">6</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">0</field>
            <field name="dpi">90</field>
        </record>

        <record id="qweb_document_approval_client_request" model="ir.actions.report">
            <field name="name">Document Approval Client Request</field>
            <field name="model">document.approval</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">document_apporval_custom.report_template_document_approval_client_request_view</field>
            <field name="report_file">document_apporval_custom.report_template_document_approval_client_request_view</field>
            <field name="paperformat_id" ref="document_apporval_custom.paperformat_qweb_document_approval_client_request"/>
            <field name="print_report_name">'Client Request Report - %s' % (object.name)</field>
        </record>
    </data>
</odoo>